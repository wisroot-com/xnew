<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="../xnew.js"></script>
</head>

<body>
    <div id="main" style="width: 100%; height: 100%;"></div>
    <script>
        
        xnew(document.querySelector('#main'), (xnode) => {
            xnew(Div1);
            xnew(Div2);
            xnew(Div3);
            xnew(Div4);
        });

        function Div1(xnode) {
            xnest({ tagName: 'div', style: 'margin: 4px; padding: 4px; border: solid 1px #222;'});

            xnew({ tagName: 'p' }, 'my div');
            xnew({ style: 'display: flex;'}, () => {
                xnew({ style: 'width: 160px; height: 36px; background: #d66;'}, '1');
                xnew({ style: 'width: 160px; height: 36px; background: #6d6;'}, '2');
                xnew({ style: 'width: 160px; height: 36px; background: #66d;'}, '3');
            });
        }

        function Div2(xnode) {
            xnest({ tagName: 'div', style: 'margin: 4px; padding: 4px; border: solid 1px #222;'});
          
            xnew({ tagName: 'p' }, 'my button');

            const button = xnew({ tagName: 'button' }, 'click me');

            let counter = 0;
            button.on('click', () => {
                button.element.textContent = `counter: ${counter++}`;
            })
        }

        function Div3(xnode) {
            xnest({ tagName: 'div', style: 'margin: 4px; padding: 4px; border: solid 1px #222;'});
         
            xnew({ tagName: 'p' }, 'my input text');

            const input = xnew({ tagName: 'input', type: 'text' });
            const span = xnew({ tagName: 'span' });

            input.on('change input', () => {
                span.element.textContent = input.element.value;
            })
        }

        function Div4(xnode) {
            xnest({ tagName: 'div', style: 'margin: 4px; padding: 4px; border: solid 1px #222;'});
        
            xnew({ tagName: 'p' }, 'my canvas');

            const canvas = xnew({ tagName: 'canvas', width: 200, height: 100 });
            xnew(Content, canvas.element);
        }

        function Content(xnode, canvas) {
            const context = canvas.getContext('2d');
            const cx = canvas.width / 2;
            const cy = canvas.height / 2;
            const s = Math.min(cx, cy) * 0.5;

            context.fillStyle = "rgb(0,0,0)";
            context.fillRect(0, 0, canvas.width, canvas.height);

            context.fillStyle = "rgb(200,0,100)";
            context.fillRect(cx - 0.6 * cx - s, cy - s, s * 2, s * 2);

            context.fillStyle = "rgb(100,200,0)";
            context.fillRect(cx + 0.0 * cx - s, cy - s, s * 2, s * 2);

            context.fillStyle = "rgb(0,100,200)";
            context.fillRect(cx + 0.6 * cx - s, cy - s, s * 2, s * 2);
        }

    </script>
</body>
</html>